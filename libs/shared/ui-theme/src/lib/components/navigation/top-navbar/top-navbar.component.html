<!--
  ~ Copyright (c) 2024-2026. Frank-Peter AndrÃ¤
  ~ All rights reserved.
  -->

<div class="fpa-flex fpa-flex-row fpa-flex-justify-space-between fpa-bg-main-band fpa-box-shadow">
	<nav class="fpa-flex fpa-flex-row fpa-bg-main-band fpa-p-1 navbar">
		@for (navigationItem of menuItems(); track navigationItem.label) {
			<ng-container [ngTemplateOutlet]="navList" [ngTemplateOutletContext]="{ navigationItem }"></ng-container>
		}
	</nav>
	<ng-content></ng-content>
</div>

<ng-template #navList let-navigationItem="navigationItem">
	<ul>
		<ng-container [ngTemplateOutlet]="navItem" [ngTemplateOutletContext]="{ navigationItem }"></ng-container>
	</ul>
</ng-template>

<ng-template #navItem let-navigationItem="navigationItem">
	<li>
		@if (navigationItem.children) {
			<div class="nva-dropdown">
				<button
					class="nva-dropdown fpa-button-no-style fpa-p-1 fpa-light-text fpa-link"
					[ngClass]="{ 'link-active': getCurrentRoute().includes(navigationItem.route) }"
					(click)="toggleNavigation(navigationItem.route)"
					(keyup.enter)="toggleNavigation(navigationItem.route)"
					aria-haspopup="menu"
					[attr.aria-expanded]="showDropdown[navigationItem.route] ? 'true' : 'false'"
				>
					<span>{{ navigationItem.label }}</span>
				</button>
				<div
					class="dropdown-content fpa-bg-light-shades fpa-dark-text"
					[ngClass]="{ 'nav-show-dropdown': showDropdown[navigationItem.route] }"
				>
					@for (navigationItemChild of toArray(navigationItem.children); track navigationItemChild) {
						<ng-container
							[ngTemplateOutlet]="navList"
							[ngTemplateOutletContext]="{ navigationItem: navigationItemChild, color: ColorDefinition.MAIN_BAND }"
						></ng-container>
					}
				</div>
			</div>
		} @else if (navigationItem.route) {
			<a
				class="fpa-p-1 fpa-light-text fpa-link"
				[routerLink]="navigationItem.route"
				[ngClass]="{ 'link-active': getCurrentRoute() === navigationItem.route }"
				(click)="resetDropdowns()"
			>
				<span>{{ navigationItem.label }}</span>
			</a>
		}
	</li>
</ng-template>
